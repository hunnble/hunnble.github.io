
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<link rel="alternate" href="/atom.xml" type="application/atom+xml">
<title>React-生命周期 [ 北方公园 ]</title>
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="stylesheet" href="/css/default_highlight.min.css">
<link rel="stylesheet" href="/libs/fancybox/source/jquery.fancybox.css" type="text/css" media="screen">
<link rel="stylesheet" href="/css/main.css">
</head>
<body>
<div class="navbar-fixed white-text">
<nav class="transparent z-depth-0">
<div class="nav-wrapper">
<ul id="nav-mobile" class="right hide-on-med-and-down">
<li>
<a class="waves-effect text-lighten-4" href="/">主页</a>
</li>
<li>
<a class="waves-effect text-lighten-4" href="/archive">归档</a>
</li>
<li>
<a class="waves-effect text-lighten-4" href="/about">关于</a>
</li>
</ul>
<a href="#" data-activates="slide-nav" class="button-collapse text-lighten-4" id="side-nav-switcher"><i class="material-icons">menu</i></a>
</div>
</nav>
</div>
<ul id="slide-nav" class="side-nav">
<li>
<div class="userView lighten-2 teal">
<div class="background">
<h5 class="white-text inline-title">Noski</h5>
</div>
<img class="circle" src="/images/avatar.png">
<h5 class="white-text inline-title">北方公园</h5>
<br>
<h5 class="white-text inline-title">Web/书和思考/一派胡言</h5>
</div>
</li>
<li><a class="waves-effect lighten-2 teal-text" href="/">主页</a></li>
<li><a class="waves-effect lighten-2 teal-text" href="/archive">归档</a></li>
<li><a class="waves-effect lighten-2 teal-text" href="/about">关于</a></li>
</ul>
<div class="parallax-container valign-wrapper hide-on-small-only" style="height:400px">
<div class="parallax lighten-2 teal">
<img src="/images/background.jpg">
</div>
<script type="text/javascript">var container=document.querySelector(".parallax-container"),tmpTitle=container.querySelector(".hide-on-image-load"),img=container.querySelector("img");img.onload=function(){tmpTitle&&(tmpTitle.style.display="none")}</script>
</div>
<main id="container-outer" class="">
<div class="row">
<div class="col s12 m10 push-m1 l8 push-l2" id="container-inner">
<section id="post" class="card article z-depth-0">
<div class="card-panel z-depth-0 black-text">
<h1>React-生命周期</h1>
<div class="valign-wrapper blue-grey-text">
<i class="material-icons valign">query_builder</i>&nbsp
<time datetime="2016-05-04T04:00:48.000Z" class="valign">
2016 5月 4日 中午12:0:48
</time>
</div>
<div class="valign-wrapper sm-text blue-grey-text">
<i class="material-icons valign">grade</i>&nbsp
<span id="busuanzi_container_page_pv" class="valign">
阅读<span id="busuanzi_value_page_pv"></span>次
</span>
</div>
<div class="section right">
<span class="new badge amber left" data-badge-caption="">
<a href="/tag/frontend/" title="#frontend" class="white-text" target="_blank" rel="external">#frontend</a>
</span>
</div>
</div>
<div class="card-content z-depth-0">
<p>组件可以被看作一个状态机，对输入返回对应的输出。React为组件提供了生命周期钩子函数来相应不同时刻。这篇博客将依次介绍。<br><a id="more"></a></p>
<h3 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h3><p>首次使用一个组件类时，你会看到下面这些方法依次被调用：</p>
<ul>
<li>getDefaultProps</li>
<li>getInitialState</li>
<li>componentWillMount</li>
<li>render</li>
<li>componentDidMount<br>后续应用时下面这些方法依次被调用：</li>
<li>getInitialState</li>
<li>componentWillMount</li>
<li>render</li>
<li>componentDidMount<br>注意，getDefaultProps已经不在了。<h3 id="存在期"><a href="#存在期" class="headerlink" title="存在期"></a>存在期</h3>随着应用状态的改变，下面的方法依次被调用：</li>
<li>componentWillReceiveProps</li>
<li>shouldComponentUpdate</li>
<li>componentWillUpdate</li>
<li>render</li>
<li>componentDidUpdate<h3 id="销毁-amp-清理期"><a href="#销毁-amp-清理期" class="headerlink" title="销毁&amp;清理期"></a>销毁&amp;清理期</h3>只有一个方法被调用，用来清理：</li>
<li>componentWillUnmount</li>
</ul>
<h3 id="下面介绍部分方法"><a href="#下面介绍部分方法" class="headerlink" title="下面介绍部分方法"></a>下面介绍部分方法</h3><h5 id="getDefaultProps"><a href="#getDefaultProps" class="headerlink" title="getDefaultProps"></a>getDefaultProps</h5><p>对于那些没有被父辈组件指定props属性的新建实例来说，这个方法返回的对象可用于为实例设置默认的props值。</p>
<h5 id="getInitialState"><a href="#getInitialState" class="headerlink" title="getInitialState"></a>getInitialState</h5><p>对于每个实例，这个方法只调用一次，用于初始化state。</p>
<h5 id="componentWillMount"><a href="#componentWillMount" class="headerlink" title="componentWillMount"></a>componentWillMount</h5><p>在首次渲染之前调用</p>
<h5 id="render"><a href="#render" class="headerlink" title="render"></a>render</h5><p>这个方法用来渲染，首先创建一个虚拟DOM，render是组件唯一必须的方法。需要满足下面几点：</p>
<ul>
<li>只能通过this.props和this.state访问数据</li>
<li>可以返回null、false或者任何React组件</li>
<li>只能出现一个顶级组件</li>
<li>不能改变组件的状态<h5 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h5>已经可以访问到渲染出的组件。<h5 id="componentWillReceiveProps"><a href="#componentWillReceiveProps" class="headerlink" title="componentWillReceiveProps"></a>componentWillReceiveProps</h5>父辈组件修改props时调用，可以在这个方法里更新内部state<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">componentWillReceiveProps: <span class="function"><span class="keyword">function</span> (<span class="params">nextProps</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">        <span class="attr">lastState</span>: nextProps</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h5><p>如果设置返回值为false，则组件不会渲染新的props或者state，也就是跳过render方法和componentWillUpdate、componentDidUpdate。</p>
<h5 id="componentWillUpdate、componentDidUpdate"><a href="#componentWillUpdate、componentDidUpdate" class="headerlink" title="componentWillUpdate、componentDidUpdate"></a>componentWillUpdate、componentDidUpdate</h5><p>和componentWillMount、componentDidMount类似</p>
<h5 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h5><p>组件从层级结构中移除之前这个方法会被调用。可以清理事件监听器、定时器等。</p>
<p>下个博客打算写数据流</p>
<div class="sibling-post center-align card-panel z-depth-0 section">
<a href="/2016/05/04/React-简介/" class="btn-flat blue-grey-text right">
<i class="material-icons right">chevron_right</i>
React 简介, JSX
</a>
<a href="/2016/05/04/React-数据流/" class="btn-flat blue-grey-text left">
<i class="material-icons left">chevron_left</i>
React-数据流
</a>
</div>
<div class="comment" id="duoshuo">
<div class="ds-thread" data-thread-key="post-React-生命周期" data-title="React-生命周期" data-url="http://hunnble.github.io/2016/05/04/React-生命周期/"></div>
<script type="text/javascript">var duoshuoQuery={short_name:"hunnble"},ds=document.createElement("script");ds.type="text/javascript",ds.async=!0,ds.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",ds.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(ds)</script>
</div>
</div>
</section>
<div class="fixed-action-btn click-to-toggle">
<a class="btn-floating btn-large lighten-2 teal">
<i class="large material-icons">view_module</i>
</a>
<ul>
<li>
<a id="back-to-top" class="btn-floating lighten-2 teal waves-effect %>" href="#">
<i class="material-icons">navigation</i>
</a>
</li>
</ul>
</div>
</div>
<aside class="col m2 push-m2 hide-on-med-and-down">
<div class="toc transparent card-panel z-depth-0">
<ol class="table-of-contents"><li class="table-of-contents-item table-of-contents-level-3"><a class="table-of-contents-link" href="#实例化"><span class="table-of-contents-text">实例化</span></a></li><li class="table-of-contents-item table-of-contents-level-3"><a class="table-of-contents-link" href="#存在期"><span class="table-of-contents-text">存在期</span></a></li><li class="table-of-contents-item table-of-contents-level-3"><a class="table-of-contents-link" href="#销毁-amp-清理期"><span class="table-of-contents-text">销毁&清理期</span></a></li><li class="table-of-contents-item table-of-contents-level-3"><a class="table-of-contents-link" href="#下面介绍部分方法"><span class="table-of-contents-text">下面介绍部分方法</span></a><ol class="table-of-contents-child"><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#getDefaultProps"><span class="table-of-contents-text">getDefaultProps</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#getInitialState"><span class="table-of-contents-text">getInitialState</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#componentWillMount"><span class="table-of-contents-text">componentWillMount</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#render"><span class="table-of-contents-text">render</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#componentDidMount"><span class="table-of-contents-text">componentDidMount</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#componentWillReceiveProps"><span class="table-of-contents-text">componentWillReceiveProps</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#shouldComponentUpdate"><span class="table-of-contents-text">shouldComponentUpdate</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#componentWillUpdate、componentDidUpdate"><span class="table-of-contents-text">componentWillUpdate、componentDidUpdate</span></a></li><li class="table-of-contents-item table-of-contents-level-5"><a class="table-of-contents-link" href="#componentWillUnmount"><span class="table-of-contents-text">componentWillUnmount</span></a></li></ol></li></ol>
</div>
</aside>
</div>
</main>
<footer class="page-footer lighten-2 teal">
<div class="container section">
<div class="center-align white-text text-lighten-4">
<p>
Powerd by <a href="https://hexo.io/zh-cn/" title="hexo" target="_blank" rel="external">hexo</a>. Theme by <a href="https://github.com/hunnble/hexo-theme-immortal" title="immortal" target="_blank" rel="external">immortal</a>.
</p>
<h5>
总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
总访客数&nbsp;<span id="busuanzi_value_site_uv"></span>
</h5>
</div>
</div>
<div class="footer-copyright center-align">
Copyright © 2016 Noski
</div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="/js/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/materialize/0.97.8/js/materialize.min.js"></script>
<script type="text/javascript" src="/libs/fancybox/source/jquery.fancybox.pack.js"></script>
<script type="text/javascript" src="/js/main.js"></script>
</body>
</html>
